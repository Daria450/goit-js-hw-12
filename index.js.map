{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios, { isCancel, AxiosError } from 'axios';\n\n\n\n\nexport async function searchImages(searchedImage, page) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const params = new URLSearchParams({\n        key: \"48899648-ccb58b22bf2a70621fef2a532\",\n        q: searchedImage,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: '40',\n        page: page,\n    });\n    const url = `${BASE_URL}?${params}`;\n    const data = await axios(url);\n    return data;\n}\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nexport function galleryTemplate(images) {\n  return images\n    .map((image) => `<li class=\"gallery-item\">\n        <div class=\"img-container\">\n  <a class=\"gallery-link\" href=${image.largeImageURL}> \n    <img\n      class=\"gallery-image\"\n      src=${image.webformatURL}\n      data-source=${image.largeImageURL}\n      alt=${image.tags}\n      height = 200\n      width = 360\n    />\n  </a>\n  </div>\n  <ul class=\"img-data\">\n  <li class =\"img-data-item\">\n    <p class=\"data-name\">Likes</p>\n    <p class=\"data-value\">${image.likes}</p> \n  </li>\n   <li class =\"img-data-item\">\n    <p class=\"data-name\">Views</p>\n    <p class=\"data-value\">${image.views}</p> \n  </li>\n  <li class =\"img-data-item\">\n    <p class=\"data-name\">Comments</p>\n    <p class=\"data-value\">${image.comments}</p> \n  </li>\n  <li class =\"img-data-item\">\n    <p class=\"data-name\">Downloads</p>\n    <p class=\"data-value\">${image.downloads}</p> \n  </li>\n  </ul>\n</li> `)\n    .join(\"\");\n}\n\nexport function renderGallery(images) {\n  const markup = galleryTemplate(images);\n  return markup;\n}\n\n\n","// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { renderGallery } from \"./js/render-functions\";\nimport { searchImages } from \"./js/pixabay-api\";\n\nconst refs = {\n  searchForm: document.querySelector(\".search-form\"),\n  searchInput: document.querySelector(\".request\"),\n  searchBtn: document.querySelector(\".search-button\"),\n  gallery: document.querySelector(\".gallery\"),\n  loader: document.querySelector(\".loader\"),\n  loadBtn: document.querySelector(\".load\"),\n}\nconst refreshPage = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nrefs.loader.style.display = 'none';\nrefs.loadBtn.style.display = 'none';\nconst queryParams = {\n  query: '',\n  page: 1,\n  total: 40,\n}\n\nrefs.searchForm.addEventListener('submit', async (e) => {\n\n  e.preventDefault();\n  queryParams.query = e.target.elements.query.value.trim();\n  queryParams.page = 1;\n\n\n\n  if (!queryParams.query) {\n    iziToast.error({\n      title: 'Error',\n      messageColor: 'white',\n      message: 'Input is empty',\n      position: 'topRight',\n      backgroundColor: '#EF4040',\n      theme: \"dark\",\n    });\n    return\n  }\n\n\n  refs.loader.style.display = 'inline-block';\n\n\n\n  try {\n    const res = await searchImages(queryParams.query, queryParams.page);\n    const img = res.data.hits;\n    refs.loader.style.display = 'none';\n    if (res.data.hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        titleColor: 'white',\n        messageColor: 'white',\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        backgroundColor: '#EF4040',\n        iconColor: 'white',\n        overlayColor: '#EF4040',\n        theme: \"dark\",\n      });\n    } else {\n      const markup = renderGallery(img);\n      refs.gallery.innerHTML = markup;\n      refreshPage.refresh();\n      refs.loadBtn.style.display = 'block';\n    }\n  } catch (err) {\n    refs.loader.style.display = 'none';\n    iziToast.error({\n      title: 'Error',\n      titleColor: 'white',\n      messageColor: 'white',\n      message: `Sorry, unexpected error:${err} occured!`,\n      position: 'topRight',\n      backgroundColor: '#EF4040',\n      iconColor: 'white',\n      overlayColor: '#EF4040',\n      theme: \"dark\",\n    });\n  }\n  e.target.reset();\n}\n)\n\n\nrefs.loadBtn.addEventListener('click', loadMore);\n\nasync function loadMore() {\n  queryParams.page += 1;\n\n  try {\n    const res = await searchImages(queryParams.query, queryParams.page);\n\n    const img = res.data.hits;\n    refs.loader.style.display = 'none';\n    const markup = renderGallery(img);\n    refs.gallery.insertAdjacentHTML(\"beforeend\", markup);\n    refreshPage.refresh();\n\n    queryParams.total = res.data.total;\n    checkBtnStatus()\n  } catch (err) {\n    refs.loader.style.display = 'none';\n    iziToast.error({\n      title: 'Error',\n      titleColor: 'white',\n      messageColor: 'white',\n      message: `Sorry, unexpected error:${err} occured!`,\n      position: 'topRight',\n      backgroundColor: '#EF4040',\n      iconColor: 'white',\n      overlayColor: '#EF4040',\n      theme: \"dark\",\n    });\n  }\n}\n\nfunction checkBtnStatus() {\n  const perPage = 40;\n  const maxPage = Math.ceil(queryParams.total / perPage);\n\n  if (queryParams.page >= maxPage) {\n    refs.loadBtn.style.display = \"none\";\n    refs.gallery.insertAdjacentHTML(\"afterend\", \"<p class='no-results'>We're sorry, but you've reached the end of search results.</p>\")\n  }\n  else {\n    refs.loadBtn.style.display = \"block\";\n  }\n  scrollDown();\n}\n\nfunction scrollDown() {\n  const card = document.querySelector('.gallery li');\n  const cardHeight = card.getBoundingClientRect().height;\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  })\n\n}"],"names":["searchImages","searchedImage","page","BASE_URL","params","url","axios","galleryTemplate","images","image","renderGallery","refs","refreshPage","SimpleLightbox","queryParams","e","iziToast","res","img","markup","err","loadMore","checkBtnStatus","maxPage","scrollDown","cardHeight"],"mappings":"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"}